<%= render Common::ModalComponent.new do |modal| %>
  <% modal.with_modal_content do %>
    <%= link_to select_all_boxes_path, data: { turbo_frame: "_top" }, class: "flex justify-between items-center self-stretch flex-grow-0 flex-shrink-0 py-2" do %>
      <span class="flex-grow-0 flex-shrink-0 text-base font-medium text-left text-gray-900">
      Všetky schránky
    </span>
      <span class="flex-grow-0 flex-shrink-0 text-sm text-left text-gray-600 px-1.5 py-0.5 rounded-md bg-gray-50 border border-gray-300">
      <%= @all_unread_messages_count %>
    </span>
    <% end %>
    <hr>
    <div class="flex flex-col gap-2 mb-4">
      <% if @boxes_with_unread_message_counts.length > FILTER_IF_NUMBER_OF_BOXES_ABOVE %>
        <%= form_with url: search_boxes_path, class: "flex justify-start items-center self-stretch flex-grow-0 flex-shrink-0 mt-4" do |form| %>
          <div class="flex w-full items-center rounded-md shadow-sm ring-1 ring-inset ring-gray-300 focus-within:ring-2 focus-within:ring-inset focus-within:ring-indigo-600">
            <div class="p-2">
              <%= render Icons::MagnifyingGlassComponent.gray(size: "4") %>
            </div>
            <%= tag.turbo_frame id: "box-search-results" %>
            <%= form.search_field :name_search, value: params[:name_search], placeholder: "Vyhľadaj schránku",
                                  oninput: "this.form.requestSubmit()",
                                  onreset: "this.form.requestSubmit()",
                                  autofocus: true,
                                  class: "block w-full flex-1 border-0 bg-transparent py-1.5 pl-1 text-gray-900 placeholder:text-gray-400 focus:ring-0 sm:text-sm sm:leading-6" %>
          </div>
        <% end %>
      <% end %>
      <%= tag.turbo_frame id: "box-list", class: "flex-col self-stretch mt-2" do %>
        <% @boxes_with_unread_message_counts.each do |box, unread_message_count| %>
          <%= render Layout::BoxListComponent.new(box: box, unread_message_count: unread_message_count) %>
        <% end %>
      <% end %>
    </div>

    <%= render Common::ModalActionsComponent.new %>
  <% end %>
<% end %>

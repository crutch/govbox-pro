<% if @message.form.present? %>
      <div class="w-fit" data-controller="dropdown" data-action="click->dropdown#toggle click@window->dropdown#hide">
        <div id="dropdown-button" class="relative inline-block">
          <div role="button" tabindex="0" data-dropdown-target="button" class="inline-block select-none">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="  w-5 h-5 relative" preserveAspectRatio="xMidYMid meet">
              <path d="M9.41107 4.75592C9.56735 4.9122 9.77931 5 10.0003 5C10.2213 5 10.4333 4.9122 10.5896 4.75592C10.7459 4.59964 10.8337 4.38768 10.8337 4.16667C10.8337 3.94566 10.7459 3.73369 10.5896 3.57741C10.4333 3.42113 10.2213 3.33334 10.0003 3.33334C9.77931 3.33334 9.56735 3.42113 9.41107 3.57741C9.25479 3.73369 9.16699 3.94566 9.16699 4.16667C9.16699 4.38768 9.25479 4.59964 9.41107 4.75592Z" fill="#111827"></path>
              <path d="M9.41107 10.5893C9.56735 10.7455 9.77931 10.8333 10.0003 10.8333C10.2213 10.8333 10.4333 10.7455 10.5896 10.5893C10.7459 10.433 10.8337 10.221 10.8337 10C10.8337 9.77899 10.7459 9.56703 10.5896 9.41075C10.4333 9.25447 10.2213 9.16667 10.0003 9.16667C9.77931 9.16667 9.56735 9.25447 9.41107 9.41075C9.25479 9.56703 9.16699 9.77899 9.16699 10C9.16699 10.221 9.25479 10.433 9.41107 10.5893Z" fill="#111827"></path>
              <path d="M9.41107 16.4226C9.56735 16.5789 9.77931 16.6667 10.0003 16.6667C10.2213 16.6667 10.4333 16.5789 10.5896 16.4226C10.7459 16.2663 10.8337 16.0543 10.8337 15.8333C10.8337 15.6123 10.7459 15.4004 10.5896 15.2441C10.4333 15.0878 10.2213 15 10.0003 15C9.77931 15 9.56735 15.0878 9.41107 15.2441C9.25479 15.4004 9.16699 15.6123 9.16699 15.8333C9.16699 16.0543 9.25479 16.2663 9.41107 16.4226Z" fill="#111827"></path>
              <path d="M10.0003 4.16667V4.175M10.0003 10V10.0083M10.0003 15.8333V15.8417M10.0003 5C9.77931 5 9.56735 4.9122 9.41107 4.75592C9.25479 4.59964 9.16699 4.38768 9.16699 4.16667C9.16699 3.94566 9.25479 3.73369 9.41107 3.57741C9.56735 3.42113 9.77931 3.33334 10.0003 3.33334C10.2213 3.33334 10.4333 3.42113 10.5896 3.57741C10.7459 3.73369 10.8337 3.94566 10.8337 4.16667C10.8337 4.38768 10.7459 4.59964 10.5896 4.75592C10.4333 4.9122 10.2213 5 10.0003 5ZM10.0003 10.8333C9.77931 10.8333 9.56735 10.7455 9.41107 10.5893C9.25479 10.433 9.16699 10.221 9.16699 10C9.16699 9.77899 9.25479 9.56703 9.41107 9.41075C9.56735 9.25447 9.77931 9.16667 10.0003 9.16667C10.2213 9.16667 10.4333 9.25447 10.5896 9.41075C10.7459 9.56703 10.8337 9.77899 10.8337 10C10.8337 10.221 10.7459 10.433 10.5896 10.5893C10.4333 10.7455 10.2213 10.8333 10.0003 10.8333ZM10.0003 16.6667C9.77931 16.6667 9.56735 16.5789 9.41107 16.4226C9.25479 16.2663 9.16699 16.0543 9.16699 15.8333C9.16699 15.6123 9.25479 15.4004 9.41107 15.2441C9.56735 15.0878 9.77931 15 10.0003 15C10.2213 15 10.4333 15.0878 10.5896 15.2441C10.7459 15.4004 10.8337 15.6123 10.8337 15.8333C10.8337 16.0543 10.7459 16.2663 10.5896 16.4226C10.4333 16.5789 10.2213 16.6667 10.0003 16.6667Z" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
          </div>
          <div data-dropdown-target="menu"
               data-transition-enter="transition ease-out duration-100"
               data-transition-enter-from="transform opacity-0 scale-9"
               data-transition-enter-to="transform opacity-100 scale-100"
               data-transition-leave="transition ease-in duration-75"
               data-transition-leave-from="transform opacity-100 scale-100"
               data-transition-leave-to="transform opacity-0 scale-95"
               class="hidden absolute right-0 z-10">
            <div class="flex flex-col justify-start items-stretch gap-px py-0.5 rounded-lg bg-white border border-gray-300 mt-1" style="box-shadow: 1px 1px 4px 0 rgba(0,0,0,0.1);">
              <div class="flex flex-col justify-start items-stretch relative gap-1">
                <div class="flex justify-stretch items-start px-4 py-3 rounded-lg hover:bg-gray-50">
                  <%= link_to download_message_message_object_path(@message, @message.form), data: { turbo_frame: '_top' }, class: 'whitespace-nowrap' do %>
                    <div class="flex justify-center items-center relative gap-3">
                      <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="  w-5 h-5 " preserveAspectRatio="xMidYMid meet">
                        <path d="M6.64661 10.3535L9.6465 13.3534C9.64652 13.3534 9.64654 13.3534 9.64655 13.3534C9.74031 13.4471 9.86744 13.4998 10 13.4998C10.1326 13.4998 10.2597 13.4471 10.3534 13.3534C10.3535 13.3534 10.3535 13.3534 10.3535 13.3534L13.3534 10.3534L13.3596 10.3473L13.3596 10.3474C13.4074 10.3012 13.4455 10.2461 13.4717 10.1851C13.4979 10.1241 13.5117 10.0584 13.5123 9.99206C13.5128 9.92567 13.5002 9.85983 13.4751 9.79838C13.4499 9.73693 13.4128 9.68111 13.3658 9.63416C13.3189 9.58721 13.2631 9.55009 13.2016 9.52495C13.1402 9.4998 13.0743 9.48715 13.0079 9.48773C12.9416 9.48831 12.8759 9.5021 12.8149 9.5283C12.7539 9.55451 12.6988 9.5926 12.6526 9.64036L12.6466 9.64661L12.6466 9.64655L11.3536 10.9396L10.5 11.7931V10.586V3C10.5 2.86739 10.4473 2.74021 10.3536 2.64645C10.2598 2.55268 10.1326 2.5 10 2.5C9.86739 2.5 9.74021 2.55268 9.64645 2.64645C9.55268 2.74021 9.5 2.86739 9.5 3V10.586V11.7931L8.64645 10.9396L7.3535 9.64661C7.35348 9.64659 7.35346 9.64657 7.35345 9.64655C7.25969 9.55285 7.13256 9.50021 7 9.50021C6.86747 9.50021 6.74036 9.55283 6.64661 9.6465C6.64657 9.64654 6.64654 9.64657 6.6465 9.64661M6.64661 10.3535L6.293 10.707C6.10553 10.5195 6.00021 10.2652 6.00021 10C6.00021 9.73484 6.10553 9.48053 6.293 9.293L6.6465 9.64661M6.64661 10.3535C6.64659 10.3535 6.64657 10.3535 6.64655 10.3534M6.64661 10.3535L6.64655 10.3534M6.6465 9.64661C6.55283 9.74036 6.50021 9.86747 6.50021 10C6.50021 10.1326 6.55285 10.2597 6.64655 10.3534M6.6465 9.64661L6.64655 10.3534M3.5 17C3.5 16.8674 3.55268 16.7402 3.64645 16.6464C3.74021 16.5527 3.86739 16.5 4 16.5H16C16.1326 16.5 16.2598 16.5527 16.3536 16.6464C16.4473 16.7402 16.5 16.8674 16.5 17C16.5 17.1326 16.4473 17.2598 16.3536 17.3536C16.2598 17.4473 16.1326 17.5 16 17.5H4C3.86739 17.5 3.74021 17.4473 3.64645 17.3536C3.55268 17.2598 3.5 17.1326 3.5 17Z" fill="#111827" stroke="#111827"></path>
                      </svg>
                      Stiahnuť správu
                    </div>
                  <% end %>
                </div>
              </div>
              <% if @mode == 'thread_view' %>
                <div class="flex flex-col justify-start items-stretch relative gap-1">
                  <div class="flex justify-stretch items-start px-4 py-3 rounded-lg hover:bg-gray-50">
                    <% if @message.collapsed %>
                      <%= button_to message_path(@message), params: { collapsed: false }, method: :patch, class: 'whitespace-nowrap' do %>
                        <div class="flex justify-center items-center relative gap-3">
                          <%= render Icons::UncollapseComponent.new(:black) %>
                          Vždy zobrazovať
                        </div>
                      <% end %>
                    <% else %>
                      <%= button_to message_path(@message), params: { collapsed: true }, method: :patch, class: 'whitespace-nowrap' do %>
                        <div class="flex justify-center items-center relative gap-3">
                          <%= render Icons::CollapseComponent.new(:black) %>
                          Zbaliť a už nerozbaľovať
                        </div>
                      <% end %>
                    <% end %>
                  </div>
                </div>
              <% end %>
            </div>
          </div>
        </div>
      </div>
  <% end %>

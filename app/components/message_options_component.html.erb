<% if @message.form.present? %>
  <%= render Common::OptionsComponent.new(id: "message-options") do |options| %>
    <% options.with_menu_content do %>
      <%= link_to download_message_message_object_path(@message, @message.form), data: { turbo_frame: '_top' }, class: 'whitespace-nowrap flex gap-3', role: 'menu-item', tabindex: -1 do %>
        <%= render Icons::ArrowDownTrayComponent.new(css_classes: "w-5 h-5") %>
        Stiahnuť správu
      <% end %>
      <% if @message.replyable? %>
        <%= content_tag(:div, { "data-controller": "message-drafts" }) do %>
          <%= button_to message_drafts_path, params: { original_message_id: @message.id }, method: :post, class: 'whitespace-nowrap flex gap-3', role: 'menu-item', tabindex: -1 do %>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" data-slot="icon" class="shrink-0 w-5 h-5">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9 15 3 9m0 0 6-6M3 9h12a6 6 0 0 1 0 12h-3" />
            </svg>
            Odpovedať
          <% end %>
        <% end %>
      <% end %>
      <% if @mode == :thread_view && @message.collapsible? %>
        <% if @message.collapsed %>
          <%= button_to message_path(@message), params: { collapsed: false }, method: :patch, class: 'whitespace-nowrap flex gap-3', role: 'menu-item', tabindex: -1 do %>
              <%= render Icons::ChevronDownComponent.new(css_classes: "w-5 h-5") %>
              Vždy zobrazovať
          <% end %>
        <% else %>
          <%= button_to message_path(@message), params: { collapsed: true }, method: :patch, class: 'whitespace-nowrap flex gap-3', role: 'menu-item', tabindex: -1 do %>
            <%= render Icons::ChevronUpComponent.new(css_classes: "w-5 h-5") %>
            Zbaliť a už nerozbaľovať
          <% end %>
        <% end %>
      <% end %>
    <% end %>
  <% end %>
<% end %>

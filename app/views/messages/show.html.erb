<% if @collapsed %>
  <%= render CollapsedMessageComponent.new(message: @message) %>
<% else %>
  <%= render MessageComponent.new(message: @message, mode: @mode) do |component| %>
    <% @message.objects.each do |message_object| %>
      <% component.with_attachment do %>
        <%= render MessageAttachmentComponent.new(message: @message, message_attachment: message_object) %>
      <% end %>
    <% end %>
  <% end %>
<% end %>
